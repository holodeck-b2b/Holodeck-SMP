<!-- 
 * Copyright (C) 2025 The Holodeck B2B Team
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the Affero GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Holodeck SMP Server Administration</title>
	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap/css/bootstrap.min.css} "/>
	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap-icons/font/bootstrap-icons.css}"/>
	<link th:rel="stylesheet" th:href="@{/css/main.css} "/>
</head>
<body>
<div class="container">
    <div class="w-25 position-absolute top-50 start-50 translate-middle">
        <div class="col h-auto d-table">
            <div class="card d-table-cell align-middle">
                <div class="card-header">
					<div class="row mx-5 my-2">
						<img th:src='@{/img/logo.png}'/>
					</div>
					<div class="row mx-1 text-center">
						<span class="fs-4">2FA Verification</span>
					</div>
                </div>
				<div class="card-body">
					<div class="row mb-3">
						<div class="col">
							<div th:if="${param.error}" class="alert alert-danger p-2">
								<div th:if="${session.SPRING_SECURITY_LAST_EXCEPTION instanceof T(org.springframework.security.authentication.LockedException)}">
									Sorry, you've exceeded the maximum number of attempts to enter your 2FA code.
									Please contact your company's administrator to unlock your account.
								</div> 
								<div th:unless="${session.SPRING_SECURITY_LAST_EXCEPTION instanceof T(org.springframework.security.authentication.LockedException)}" >
									The provided code could not be validated, it may have expired. Please try again.						
								</div>	
							</div>
						</div>
					</div>    
					<form th:action="@{/verify/totp}" method="post" >
					<div class="row mb-3">
						<div class="col">You need to verify this login by entering the six digit code shown in your 
								[[${device}]] authenticator app.</div>
					</div>
					<div class="row mb-3">
						<div class="col">						
							<input type="text" name="code" class="form-control" pattern="\d{6,6}"
									required autofocus placeholder="999 999">
							<div class="invalid-feedback">Please provide the 6 digit code from authenticator app</div>
						</div>						
					</div>
					<div class="row mx-3">
						<button type="submit" class="btn btn-primary">Verify login</button>
					</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
</body>
</html>
